<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{data.title}}</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css" />
  <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
  <style>
    /* Custom styles */
    .checkbox {
      color: #949494;
    }
  </style>
</head>
<body>
  <a class="github-fork-ribbon" href="https://github.com/roharon/org-invite-automation" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a>
  <section class="hero is-info is-fullheight">
    <div class="hero-body">
      <div class="container has-text-centered">
        <div class="column is-6 is-offset-3">
          <h1 class="title">
            Join to Github Organization
          </h1>
          <h2 class="subtitle" id="org_name">
            {{ data.org_name }}
          </h2>
          <div class="box">
            <div class="field is-grouped">
              <p class="control is-expanded has-icons-left">
                <input class="input is-rounded is-hovered is-dark" id="username" placeholder="Your Github username">
                <span class="icon is-small is-left ">
                  <i class="fa fa-user-circle" aria-hidden="true"></i>
                </span>
              </p>
            </div>
            <div class="field is-grouped">
              <p class="control is-expanded has-icons-left">
                <input class="is-rounded input is-dark" type="email" id="email" placeholder="Your Email Address">
                <span class="icon is-small is-left">
                  <i class="fa fa-envelope" aria-hidden="true"></i>
                </span>
              </p>
            </div>
            <div class="field is-grouped">
              <p class="control is-expanded has-icons-left">
                <label class="checkbox">
                  <input type="checkbox" id="confirmation">
                  I agree to the {{data.company}} contribution guidelines.
                </label>
              </p>
            </div>
            <br>
            <div class="field is-grouped is-grouped-right">
              <p class="control">
                <button class="button is-info" id="submit" title="submit">Invite</button>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</body>
<script>
  var submit = document.getElementById("submit");
  submit.addEventListener("click", request_submit);

  function request_submit(evt) {
      evt.preventDefault();

      var username = document.getElementById("username").value
      var email = document.getElementById("email").value

      fetch("/api/invite", {
        method: "PUT",
        headers: new Headers({
          "content-type": "application/json"
        }),
        body: JSON.stringify({
          username: username,
          email: email
        })
      })
      .then(res => {
          if (res.status === 200) {
              window.location.href = "/success";
          } else if (res.status === 400) {
              return res.json().then(response => {
                  alert(response.error);
              });
          } else {
              window.location.href = "/error";
          }
        });
      }
</script>

</html>
